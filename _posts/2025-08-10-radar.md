---
title: <img width="50" height="50" src="/assets/images/RADAR.png">RADAR – An Obscure Execution Artifact
date: 2025-08-10 00:00:02 +730
categories: [Resources, DFIR]
comments: true
tags: [windows-forensics, artifacts, radar,forensics,execution-artifact,heapdetection] # TAG names should always be lowercase

---
![](/assets/images/RADAR.png)
## Resource Exhaustion Detection and Resolution

In digital forensics, analysts are always hunting for **evidence of execution** — artifacts that confirm a program ran on a system. While common sources like **Prefetch**, **UserAssist**, and **Application Compatibility Cache (ShimCache)** are well known, Windows hides another gem: **RADAR (Resource Exhaustion Detection and Resolution)**.

First introduced in **Windows Vista**, RADAR silently monitors running applications, looking for abnormal memory usage patterns that might indicate a leak. When it detects suspicious behavior, it logs diagnostic information — and leaves behind a persistent registry artifact.

{% include embed/youtube.html id='edJa_SLVqOo' %}

## Registry Location

The key of interest is:
```
HKLM\Software\Microsoft\RADAR\HeapLeakDetection\DiagnosedApplications
```


Each subkey under `DiagnosedApplications` corresponds to an application RADAR has flagged. Inside each subkey you’ll typically find:

- **Application name/path**
- **LastDetectionTime** – A QWORD value storing a Windows FILETIME timestamp

This data confirms **the application was executed** and gives a **minimum execution timestamp**.

---

## Why It Matters to Forensics

### 1. Valuable on Server Systems
Many servers have **Prefetch disabled by default**, making traditional execution artifacts unavailable. RADAR fills that gap, offering rare evidence of program execution in these environments.

### 2. Strong Corroboration
In DFIR, one artifact is good — multiple, consistent artifacts are better. RADAR entries can strengthen findings from:
- Prefetch files
- UserAssist registry keys
- ShimCache
- Event logs

### 3. Timestamps with Context
`LastDetectionTime` provides the **earliest known point** the application could have run. While it doesn’t prove the exact first execution time, it’s a solid lower bound.

---

## Limitations to Keep in Mind

- **Not every app will appear** – RADAR only logs processes it deems resource-heavy or problematic.
- Well-behaved applications may leave no trace here.
- Presence often indicates a **resource consumption issue** (potentially relevant in intrusion or crash investigations).

---

## How to Investigate

### Step 1 – Registry Analysis
Use a tool like **Registry Explorer** (Eric Zimmerman) to navigate to:
```
HKLM\Software\Microsoft\RADAR\HeapLeakDetection\DiagnosedApplications
```

Export the relevant subkeys for preservation and review.

### Step 2 – Convert Timestamps
Convert the `LastDetectionTime` FILETIME QWORD into a human-readable format. This will often pinpoint when the application last triggered RADAR.

### Step 3 – Cross-Reference
Correlate RADAR entries with:
- Event Logs (System log, Event ID 2004 – **Microsoft-Windows-Resource-Exhaustion-Detector**)
- Other execution artifacts
- Performance monitoring data

---

## Event Log Correlation

When RADAR triggers, you may also find **Event ID 2004** in the System event log. These events often include:
- Virtual memory conditions
- Top resource-consuming processes
- Exact memory usage values

Matching these logs with registry entries strengthens your timeline and context.

---

## DFIR Best Practices

1. **Add RADAR to Your Standard Artifact Set**  
   Especially in server cases or systems where common execution traces are absent.

2. **Document Thoroughly**  
   Record:
   - Application name/path
   - `LastDetectionTime` (converted)
   - Supporting artifacts that confirm execution

3. **Interpret in Context**  
   RADAR entries suggest the application stressed system memory. This could indicate instability, malware behavior, or legitimate but heavy workloads.




## Conclusion

The RADAR artifact represents an **underutilized but valuable** piece of the Windows forensics puzzle. While it won't replace traditional execution artifacts like Prefetch or UserAssist, it serves as an excellent **supplementary evidence source**, particularly in server environments or when building comprehensive execution timelines.youtube

For digital forensics professionals, adding RADAR analysis to your investigative toolkit provides another layer of evidence that could prove crucial in establishing program execution and building stronger forensic cases. As with all forensic artifacts, the key is understanding both its capabilities and limitations to leverage it effectively in your investigations.

_The forensic community owes credit to researcher Harel Segev for the original research into this artifact, demonstrating once again how continuous exploration of Windows internals reveals new investigative opportunities._


---
  ![](https://media.giphy.com/media/DAtJCG1t3im1G/giphy.gif)
