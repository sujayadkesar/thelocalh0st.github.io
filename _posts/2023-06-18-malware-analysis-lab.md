---
title: <img width="50" height="50" alt="front-page port 80-shoopyu" src="https://github.com/thelocalh0st/thelocalh0st.github.io/assets/125783410/815f8770-7340-4e1f-8abc-cc5c7fb09c89"> Malware Analysis Lab Setup ðŸª²ðŸ”¬
date: 2023-06-18 00:00:02 +730
categories: [Resources, SecOps]
comments: true
tags: [blueteam,cyberlabs,secops,security-operations, malware-analysis, reverse-engineering] # TAG names should always be lowercase


---
# Building Malware analysis Lab ðŸª²ðŸ”¬

![enter image description here](https://img.helpnetsecurity.com/wp-content/uploads/2022/08/19153941/malware-analysis-tools-hns.jpg)

### Basic Architecture
```mermaid
graph TD

subgraph VirtualBox
  subgraph "Windows 7 Machine"
    subgraph "Flare VM"
	    malware-analysis-tools
    end
  end
  subgraph "Ubuntu 20.04.3 LTS Machine"
  end
end
```


## 1 Install VirtualBox ðŸ“¦

 VirtualBox is essential for setting up a malware analysis lab as it allows for the creation of isolated virtual environments, enabling safe and controlled execution of potentially harmful malware samples.

[Click here to Download Virtual Box](https://www.virtualbox.org/wiki/Downloads)

<br> <br>
## 2 Install the Operating System

Now that you have installed your virtualization software you need to install a **VM** to run the malware and install all the tools that you need.

I will install a Windows 7 32 bit machine.

[Windows 7 Home Premium SP1 (32-Bit)](https://archive.org/details/windows7homepremiumsp132bit)

> **Note:** Download could be very slow  be patient {: .prompt-tip }
![enter image description here](https://media.giphy.com/media/bMdZu3fG2ZEBO/giphy.gif)

 1. Now open VirtualBox click  **new.**
 2. Select Windows 7 32 bit and give a name to your VM.
 3. Then select the amount of RAM that you want to give to it. I suggest you to give 2500 MB of RAM.
 4.  For the next ones just leave that with the default settings.
 5. Now choose the amount of memory (ROM) that you want to give to the VM. I suggest you 40 GB of memory.

> Perfect! You have created your virtual machine. {: .prompt-warning }

## 3 Crucial things to do after windows 7 installation

{% include embed/youtube.html id='mPj7eokqDEc' %}

## 4 Flare VM Installation

 - [ ] Go to this repo https://github.com/mandiant/flare-vm
 - [ ] Download [install.ps1](https://github.com/mandiant/flare-vm/blob/main/install.ps1)  to the windows **VM**
  
 - [ ] Open that folder where you saved `install.ps1` and open the `powershell as an administrator`
 - [ ] Unblock the installation script by running:
    -   ```Unblock-File .\install.ps1```
- [ ]  Enable script execution by running:
    -   ```Set-ExecutionPolicy Unrestricted```

- [ ] One Final Command to begin the flare-vm installation process 

- Finally, execute the installer script as follow ```.\install.ps1```

-   To use the CLI-only mode with minimal user interaction:  
```.\install.ps1 -password <password> -noWait -noGui -noCheck```

> Now sit-back and relax for `3 Hours!!!.ðŸ¤¯` {:.prompt-danger }
![enter image description here](https://media.giphy.com/media/M3i6XHZUcBJc4JVtVE/giphy.gif)

## TooooLs

1.  [PeStudio](https://www.varonis.com/blog/malware-analysis-tools#PeStudio)
2.  [Process Hacker](https://www.varonis.com/blog/malware-analysis-tools#ProcessHacker)
3.  [Process Monitor (ProcMon)](https://www.varonis.com/blog/malware-analysis-tools#ProcMon)
4.  [ProcDot](https://www.varonis.com/blog/malware-analysis-tools#ProcDot)
5.  [Autoruns](https://www.varonis.com/blog/malware-analysis-tools#Autoruns)
6.  [Fiddler](https://www.varonis.com/blog/malware-analysis-tools#Fiddler)
7.  [Wireshark](https://www.varonis.com/blog/malware-analysis-tools#Wireshark)
8.  [x64dbg](https://www.varonis.com/blog/malware-analysis-tools#x64dbg)
9.  [Ghidra](https://www.varonis.com/blog/malware-analysis-tools#Ghidra)
10.  [Radare2/Cutter](https://www.varonis.com/blog/malware-analysis-tools#Cutter)
11.  [Cuckoo Sandbox](https://www.varonis.com/blog/malware-analysis-tools#Cuckoo)
